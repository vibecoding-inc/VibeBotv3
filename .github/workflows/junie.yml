name: Junie

on:
  workflow_dispatch:
    inputs:
      prompt:
        description: 'Prompt for the LLM'
        required: true
        type: string

jobs:
  junie:
    name: Vibe Coding
    runs-on: ubuntu-latest
    permissions:
      contents: write
      pull-requests: write
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      - name: Run Junie
        uses: JetBrains/junie-github-action@v0
        with:
          junie_api_key: ${{ secrets.JUNIE_API_KEY }}
          create_new_branch_for_pr: true
          prompt: ${{ github.event.inputs.prompt }}
          allowed_mcp_servers: "" # none at the moment
      - name: Output
        run: |
          echo "Branch: ${{ steps.junie.outputs.branch_name }}"
          echo "Title: ${{ steps.junie.outputs.junie_title }}"
          if [ "${{ steps.junie.outputs.pr_url }}" != "" ]; then
            echo "PR created: ${{ steps.junie.outputs.pr_url }}"
          fi
